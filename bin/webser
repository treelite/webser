#! /usr/bin/env node

var fs = require('fs');
var path = require('path');
var configPath = process.argv[2];

var config = {};

if (configPath) {
    var baseDir = path.basename(configPath);
    if (baseDir.charAt(0) == '.') {
        baseDir = path.resolve(process.cwd(), baseDir);
    }

    config = fs.readFileSync(configPath, 'utf-8');
    config = JSON.parse(config.trim());

    var dir;
    Object.keys(config).forEach(function (key) {
        if (/Dir$/.test(key)) {
            dir = config[key];
            if (dir.charAt(0) != '/') {
                config.dirs[key] = path.resolve(baseDir, dir);
            }
        }
    });
}

require('../index')(config);

/* vim: set ft=javascript : */
